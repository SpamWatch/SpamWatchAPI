version: "3.7"

secrets:
  postgres_passwd:
    file: ./secrets/.postgres-passwd

services:
  postgres:
    image: postgres:11.4-alpine
    # for production we can remove this exposed ports, as it helps in security
    # while debugging for db in prod, should be done via a client container.
    ports:
      - '5432:5432'
    secrets:
      - postgres_passwd
    environment:
      POSTGRES_USER: SpamWatchAPI
      POSTGRES_DB: SpamWatchAPI
      POSTGRES_PASSWORD_FILE: /run/secrets/postgres_passwd
  api:
    build:
      context: ./
      dockerfile: Dockerfile
    ports:
      - '6345:6345'

